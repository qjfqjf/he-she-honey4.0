<template>
	<view>
		<exam-widght 
		:dataList='QuestionList' 
		:index="index" 
		@select='selectItem' 
		@selectFinish='selectFinish' 
		@finish='finish'
		:numBoxType='numBoxType'
		:showIndexText='showIndexText'
		:numBoxShow='numBoxShow'
		>
		</exam-widght>
		
		<view style="text-align: center;padding: 20rpx;">------------分割线-----------</view>
		<view>
			<button size="mini" @tap="jump()">跳转10题</button>
			 
			<button style="margin-left: 20rpx;" size="mini" @tap="switchIndexBox()">题号显示切换</button>
			
			<button style="margin-left: 20rpx;" size="mini" @tap="switchBoxType()">题号显示类型({{numBoxType == 0? '下拉' : '弹框'}})</button>
		</view>
	</view>
</template>

<script>
	import examWidght from '../../../../components/Li-ExamWidght/Li-ExamWidght.vue';
	var _this;
	export default {
		components: {
			examWidght
		}, 
		data() {
			return {
				//题目页数
				fldTestPaperID: undefined,
				//题目号
				fldTestRecordID: undefined,
				showIndexText:true, //题号文字是否显示
				numBoxShow:false, 
				items: [],
				index: 0,
				numBoxType:0,
				QuestionList: [],
				id:'',
				QuestionUrl:'/mmpt_question/info',
			}	
		},
		onLoad: function (opt) {
			console.log(opt.e); 
			this.id = opt.e;
			console.log('id',this.id);
			// console.log(111)
			_this = this;
			setTimeout(function(){
				_this.getTestPaper();
			},100)
		},
		onUnload() {},
		methods: {
			switchBoxType(){
				this.numBoxType = this.numBoxType == 0? 1 : 0;
			},
			jump(){
				this.index = 9;
			},
			switchIndexBox(){
				this.numBoxShow = !this.numBoxShow;
			},
			finish(item) {
				console.log("-----finish------")
				console.log(item)
			},
			selectItem(item) {
				console.log("-----selectItem------")
				console.log(item)
			},
			selectFinish(item) {
				console.log("-----selectFinish------")
				console.log(item)
				let index = item.newItem.index + 1;
				let title = index + '/' + item.newItem.total

				if (item.newItem.question.questionType == 0)
					title += "  单选题";
				else if (item.newItem.question.questionType == 1)
					title += "  多选题";
				else
					title += "  填空题";
				uni.setNavigationBarTitle({
					title: title
				});
			},
			getTestPaper() {
				// let data = require('../../static/data.json')  ;
				this.$http.post(this.QuestionUrl,{
					id:this.id,
				}).then(res=>{
					console.log('res',res);
					this.fldTestPaperID = res.data.data.length;
					// this.avatar = imgUrl;
					// this.examNum = res.data.data[0]
					// this.examNum = res.data.total
				}).catch(error => {
					console.error('请求发生错误', error);
				});
				console.log(data.QuestionList)
				_this.QuestionList = data.QuestionList;
				if (_this.QuestionList.length > 0) {
					let title = '1/' + _this.QuestionList.length
					if (_this.QuestionList[0].questionType == 0)
						title += "  单选题";
					else if (_this.QuestionList[0].questionType == 1)
						title += "  多选题";
					else
						title += "  填空题";
					uni.setNavigationBarTitle({
						title: title
					});
				}
			}
		}
	}
</script>

<style>

</style>
